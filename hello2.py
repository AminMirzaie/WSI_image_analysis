# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file 'helloworld_v2.ui'
#
# Created by: PyQt5 UI code generator 5.15.4
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again.  Do not edit this file unless you know what you are doing.

import cv2
from PyQt5 import QtCore, QtGui, QtWidgets
from PyQt5.QtWidgets import QFileDialog,QDialog,QLabel,QPushButton

class Ui_MainWindow(object):
    def setupUi(self, MainWindow):
        MainWindow.setObjectName("MainWindow")
        MainWindow.resize(982, 748)
        self.centralwidget = QtWidgets.QWidget(MainWindow)
        self.centralwidget.setObjectName("centralwidget")
        self.tabWidget = QtWidgets.QTabWidget(self.centralwidget)
        self.tabWidget.setGeometry(QtCore.QRect(0, 0, 981, 701))
        self.tabWidget.setObjectName("tabWidget")
        self.tab = QtWidgets.QWidget()
        self.tab.setObjectName("tab")
        self.verticalLayoutWidget = QtWidgets.QWidget(self.tab)
        self.verticalLayoutWidget.setGeometry(QtCore.QRect(0, 30, 971, 31))
        self.verticalLayoutWidget.setObjectName("verticalLayoutWidget")
        self.verticalLayout = QtWidgets.QVBoxLayout(self.verticalLayoutWidget)
        self.verticalLayout.setContentsMargins(0, 0, 0, 0)
        self.verticalLayout.setObjectName("verticalLayout")
        self.horizontalLayout_5 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_5.setObjectName("horizontalLayout_5")
        self.reg_in_text = QtWidgets.QLabel(self.verticalLayoutWidget)
        self.reg_in_text.setAlignment(QtCore.Qt.AlignCenter)
        self.reg_in_text.setObjectName("reg_in_text")
        self.horizontalLayout_5.addWidget(self.reg_in_text)
        self.reg_in_but = QtWidgets.QPushButton(self.verticalLayoutWidget)
        self.reg_in_but.setMaximumSize(QtCore.QSize(100, 16777215))
        self.reg_in_but.setObjectName("reg_in_but")
        self.horizontalLayout_5.addWidget(self.reg_in_but)
        self.verticalLayout.addLayout(self.horizontalLayout_5)
        self.verticalLayoutWidget_2 = QtWidgets.QWidget(self.tab)
        self.verticalLayoutWidget_2.setGeometry(QtCore.QRect(0, 60, 971, 33))
        self.verticalLayoutWidget_2.setObjectName("verticalLayoutWidget_2")
        self.verticalLayout_2 = QtWidgets.QVBoxLayout(self.verticalLayoutWidget_2)
        self.verticalLayout_2.setContentsMargins(0, 0, 0, 0)
        self.verticalLayout_2.setObjectName("verticalLayout_2")
        self.horizontalLayout_6 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_6.setObjectName("horizontalLayout_6")
        self.reg_out_text = QtWidgets.QLabel(self.verticalLayoutWidget_2)
        self.reg_out_text.setAlignment(QtCore.Qt.AlignCenter)
        self.reg_out_text.setObjectName("reg_out_text")
        self.horizontalLayout_6.addWidget(self.reg_out_text)
        self.reg_out_but = QtWidgets.QPushButton(self.verticalLayoutWidget_2)
        self.reg_out_but.setMaximumSize(QtCore.QSize(100, 16777215))
        self.reg_out_but.setObjectName("reg_out_but")
        self.horizontalLayout_6.addWidget(self.reg_out_but)
        self.verticalLayout_2.addLayout(self.horizontalLayout_6)
        self.horizontalLayoutWidget_2 = QtWidgets.QWidget(self.tab)
        self.horizontalLayoutWidget_2.setGeometry(QtCore.QRect(-1, 209, 981, 461))
        self.horizontalLayoutWidget_2.setObjectName("horizontalLayoutWidget_2")
        self.horizontalLayout_10 = QtWidgets.QHBoxLayout(self.horizontalLayoutWidget_2)
        self.horizontalLayout_10.setContentsMargins(0, 0, 0, 0)
        self.horizontalLayout_10.setObjectName("horizontalLayout_10")
        self.horizontalLayout_11 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_11.setObjectName("horizontalLayout_11")
        self.reg_line1_label = QtWidgets.QLabel(self.horizontalLayoutWidget_2)
        self.reg_line1_label.setMaximumSize(QtCore.QSize(100, 16777215))
        self.reg_line1_label.setAutoFillBackground(False)
        self.reg_line1_label.setStyleSheet("background:red;")
        self.reg_line1_label.setAlignment(QtCore.Qt.AlignCenter)
        self.reg_line1_label.setObjectName("reg_line1_label")
        self.horizontalLayout_11.addWidget(self.reg_line1_label)
        self.reg_line2_label = QtWidgets.QLabel(self.horizontalLayoutWidget_2)
        self.reg_line2_label.setMaximumSize(QtCore.QSize(100, 16777215))
        self.reg_line2_label.setAutoFillBackground(False)
        self.reg_line2_label.setStyleSheet("background:green;")
        self.reg_line2_label.setAlignment(QtCore.Qt.AlignCenter)
        self.reg_line2_label.setObjectName("reg_line2_label")
        self.horizontalLayout_11.addWidget(self.reg_line2_label)
        self.reg_line3_label = QtWidgets.QLabel(self.horizontalLayoutWidget_2)
        self.reg_line3_label.setMaximumSize(QtCore.QSize(100, 16777215))
        self.reg_line3_label.setAutoFillBackground(False)
        self.reg_line3_label.setStyleSheet("background:blue;")
        self.reg_line3_label.setAlignment(QtCore.Qt.AlignCenter)
        self.reg_line3_label.setObjectName("reg_line3_label")
        self.horizontalLayout_11.addWidget(self.reg_line3_label)
        self.verticalLayout_3 = QtWidgets.QVBoxLayout()
        self.verticalLayout_3.setObjectName("verticalLayout_3")
        self.verticalLayout_4 = QtWidgets.QVBoxLayout()
        self.verticalLayout_4.setObjectName("verticalLayout_4")
        self.label_7 = QtWidgets.QLabel(self.horizontalLayoutWidget_2)
        self.label_7.setMaximumSize(QtCore.QSize(16777215, 20))
        self.label_7.setObjectName("label_7")
        self.verticalLayout_4.addWidget(self.label_7)
        self.reg_log = QtWidgets.QLabel(self.horizontalLayoutWidget_2)
        self.reg_log.setAutoFillBackground(False)
        self.reg_log.setStyleSheet("background:#e5f9ff;")
        self.reg_log.setText("")
        self.reg_log.setObjectName("reg_log")
        self.verticalLayout_4.addWidget(self.reg_log)
        self.verticalLayout_3.addLayout(self.verticalLayout_4)
        self.horizontalLayout_11.addLayout(self.verticalLayout_3)
        self.horizontalLayout_10.addLayout(self.horizontalLayout_11)
        self.verticalLayoutWidget_5 = QtWidgets.QWidget(self.tab)
        self.verticalLayoutWidget_5.setGeometry(QtCore.QRect(0, 0, 971, 29))
        self.verticalLayoutWidget_5.setObjectName("verticalLayoutWidget_5")
        self.verticalLayout_7 = QtWidgets.QVBoxLayout(self.verticalLayoutWidget_5)
        self.verticalLayout_7.setContentsMargins(0, 0, 0, 0)
        self.verticalLayout_7.setObjectName("verticalLayout_7")
        self.horizontalLayout_14 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_14.setObjectName("horizontalLayout_14")
        self.reg_back_text = QtWidgets.QLabel(self.verticalLayoutWidget_5)
        self.reg_back_text.setAlignment(QtCore.Qt.AlignCenter)
        self.reg_back_text.setObjectName("reg_back_text")
        self.horizontalLayout_14.addWidget(self.reg_back_text)
        self.reg_back_but = QtWidgets.QPushButton(self.verticalLayoutWidget_5)
        self.reg_back_but.setMaximumSize(QtCore.QSize(100, 16777215))
        self.reg_back_but.setObjectName("reg_back_but")
        self.horizontalLayout_14.addWidget(self.reg_back_but)
        self.verticalLayout_7.addLayout(self.horizontalLayout_14)
        self.tabWidget.addTab(self.tab, "")
        self.tab_2 = QtWidgets.QWidget()
        self.tab_2.setObjectName("tab_2")
        self.tabWidget.addTab(self.tab_2, "")
        self.tab_3 = QtWidgets.QWidget()
        self.tab_3.setObjectName("tab_3")
        self.tabWidget.addTab(self.tab_3, "")
        self.tab_4 = QtWidgets.QWidget()
        self.tab_4.setObjectName("tab_4")
        self.tabWidget.addTab(self.tab_4, "")
        self.tab_5 = QtWidgets.QWidget()
        self.tab_5.setObjectName("tab_5")
        self.tabWidget.addTab(self.tab_5, "")
        MainWindow.setCentralWidget(self.centralwidget)
        self.menubar = QtWidgets.QMenuBar(MainWindow)
        self.menubar.setGeometry(QtCore.QRect(0, 0, 982, 22))
        self.menubar.setObjectName("menubar")
        MainWindow.setMenuBar(self.menubar)
        self.statusbar = QtWidgets.QStatusBar(MainWindow)
        self.statusbar.setObjectName("statusbar")
        MainWindow.setStatusBar(self.statusbar)

        self.retranslateUi(MainWindow)
        self.tabWidget.setCurrentIndex(0)
        QtCore.QMetaObject.connectSlotsByName(MainWindow)

    def retranslateUi(self, MainWindow):
        _translate = QtCore.QCoreApplication.translate
        MainWindow.setWindowTitle(_translate("MainWindow", "MainWindow"))
        self.reg_in_text.setText(_translate("MainWindow", "specify the first line of template file:"))
        self.reg_in_but.setText(_translate("MainWindow", "browse"))
        self.reg_out_text.setText(_translate("MainWindow", "specify the output directory to save registration file:"))
        self.reg_out_but.setText(_translate("MainWindow", "browse"))
        self.reg_line1_label.setText(_translate("MainWindow", "line 1"))
        self.reg_line2_label.setText(_translate("MainWindow", "line 2"))
        self.reg_line3_label.setText(_translate("MainWindow", "line 3"))
        self.label_7.setText(_translate("MainWindow", "log:"))
        self.reg_back_text.setText(_translate("MainWindow", "specify the R line of background file:"))
        self.reg_back_but.setText(_translate("MainWindow", "browse"))
        self.reg_back_but.clicked.connect(lambda: self.browse(self.reg_back_but))
        self.tabWidget.setTabText(self.tabWidget.indexOf(self.tab), _translate("MainWindow", "registeration"))
        self.tabWidget.setTabText(self.tabWidget.indexOf(self.tab_2), _translate("MainWindow", "calibration"))
        self.tabWidget.setTabText(self.tabWidget.indexOf(self.tab_3), _translate("MainWindow", "stich"))
        self.tabWidget.setTabText(self.tabWidget.indexOf(self.tab_4), _translate("MainWindow", "tile maker"))
        self.tabWidget.setTabText(self.tabWidget.indexOf(self.tab_5), _translate("MainWindow", "upload"))
    def showdialog(self,text):
        dlg = QDialog()
        b1 = QLabel(text, dlg)
        b1.move(50, 50)
        dlg.setWindowTitle("Alarm")
        dlg.setWindowModality(QtCore.Qt.ApplicationModal)
        dlg.exec_()
    def browse(self,but):
        path = QFileDialog.getOpenFileName(but, 'Open a file', '',
                                           'All Files (*.*)')
        if path != ('', ''):
            path = path[0]
        if not (path.split(".")[-1] == "tif"):
            self.showdialog("it's not tif file!!")
        else:
            r_path = path
            g_path = "_".join(path.split("_")[:-1]) + "_cG.tif"
            b_path = "_".join(path.split("_")[:-1]) + "_cB.tif"
            print(r_path,g_path,b_path)
            R = cv2.imread(r_path, cv2.IMREAD_GRAYSCALE)
            G = cv2.imread(g_path, cv2.IMREAD_GRAYSCALE)
            B = cv2.imread(b_path, cv2.IMREAD_GRAYSCALE)

            if R == None or G==None or B == None:
                self.showdialog("the images is not readable!!")
            else:
                self.bR = R
                self.bG = G
                self.bB = B
                pass
if __name__ == "__main__":
    import sys
    app = QtWidgets.QApplication(sys.argv)
    MainWindow = QtWidgets.QMainWindow()
    ui = Ui_MainWindow()
    ui.setupUi(MainWindow)
    MainWindow.show()
    sys.exit(app.exec_())
